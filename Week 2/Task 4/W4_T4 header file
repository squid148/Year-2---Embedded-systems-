//Week 4 Task 4 header file
#include "mbed.h"
#include "arm_book_lib.h"

DigitalIn buttons[6]={DigitalIn(D2),DigitalIn(D3),DigitalIn(D4),DigitalIn(D5),DigitalIn(D6),DigitalIn(D7)};
DigitalIn enterButton(BUTTON1); //button input initialization

DigitalOut cor_LED(LED1);
DigitalOut lock_LED(LED2);
DigitalOut incor_LED(LED3);

    int passcode[4]={2,4,5,0}; //correct passcode declare
    int admin_pass[4]={5,5,5,5}; //admin override passcode
    int user_input[4]; //declaring user input array
    int digit=0;

void flash_incor() {
    for(int f=0;f<6;f++){
    incor_LED=!incor_LED;
    ThisThread::sleep_for(200ms);
    }
}

void flash_cor() { //simple flashing 
    for(int f=0;f<6;f++){
    cor_LED=!cor_LED;
    ThisThread::sleep_for(200ms);
    }
}
void inp_flash() { //created inp_flash to help with debugging and to show when inputs are entered
    for(int f=0;f<2;f++){
    cor_LED=!cor_LED;
    ThisThread::sleep_for(200ms);
    }
}

void warn_flash() {
   for(int f=0;f<15;f++){ //loops led3 for 30 sec
    incor_LED=!incor_LED;
    ThisThread::sleep_for(2s);
    }
    incor_LED=0;
}

void unlock_flash() {
    for(int f=0;f<6;f++){
    cor_LED=!cor_LED;
    incor_LED=!incor_LED;
    lock_LED=!lock_LED;
    ThisThread::sleep_for(200ms);
    }
}

bool input_read(int& input) { //address ref or pointer used here? can use both but reference is better in general
//so learn how to use references for the future
    for (int i = 0; i < 6; i++) {
        if (buttons[i] == 1) {
            inp_flash();
            ThisThread::sleep_for(200ms); // debounce
            input=i;
            
            return true;
        }
    }
    return false;  // no button pressed
}

bool check(){
        for (int j=0;j<4;j++) {
            if (passcode[j]!=user_input[j]){//passcode is 0251
            return false;
            }
    }
    return true;
}

//removed warning since it was an unecessary functino

void lockdown() {
lock_LED=1; //set lockwon LED 
for (int f=0;f<60;f++){
    incor_LED=!incor_LED;
    ThisThread::sleep_for(1s);
}
incor_LED=0;
}

bool lock_read (int& input){//mode for lockdown to read admin code
    for (int i = 0; i < 6; i++) {
        if (buttons[i] == 1) {
            ThisThread::sleep_for(200ms); // debounce
            input=i;
            
            return true;
        }
    }
    return false;
}

bool admin_check () {
    for (int j=0;j<4;j++) {
            if (admin_pass[j]!=user_input[j]){//passcode is 0251
            return false;
            }
    }
    return true;
} 
